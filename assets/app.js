webpackJsonp([0],{171:function(a,b,c){c(118).default=c(226),c(209)},209:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(186),e=c.n(d),f=c(275),g=c.n(f),h=c(0),i=c.n(h),j=c(29),k=c.n(j),l=c(390),m=c(214),n=c(215),o=c(212),p=c(210),q=c(211);const{Sider:r,Content:s}=e.a;c.i(j.render)(i.a.createElement(l.a,null,i.a.createElement(e.a,{className:"layout-center"},i.a.createElement(r,{collapsible:!0},i.a.createElement(m.a,null)),i.a.createElement(e.a,null,i.a.createElement(s,null,i.a.createElement(l.b,null,i.a.createElement(l.c,{path:"/",exact:!0,component:n.a}),i.a.createElement(l.c,{path:"/graffiti",component:o.a}),i.a.createElement(l.c,{path:"/cover",component:p.a}),i.a.createElement(l.c,{component:q.a})))))),document.querySelector("#root"))},210:function(a,b,c){"use strict";var d=c(107),e=c.n(d),f=c(115),g=c.n(f),h=c(56),i=c.n(h),j=c(108),k=c.n(j),l=c(110),m=c.n(l),n=c(0),o=c.n(n),p=c(320),q=c.n(p),r=c(288),s=c.n(r),t=c(414),u=c.n(t),v=c(217),w=c.n(v);const x=m.a.Item;class y extends n.Component{constructor(...a){var b;return b=super(...a),this.x=0,this.y=0,this.width=0,this.height=0,this.text="",this.fileLoaded=!1,this.blobs=[],this.initCanvas=()=>{this.ctx=this.canvas.getContext("2d")},this.initCover=()=>{this.cover=new Image,this.cover.onload=()=>{this.ctx.drawImage(this.cover,0,323,500,177),this.fileLoaded&&this.renderCover()},this.cover.src=u.a},this.onCrop=(a)=>{this.x=a.detail.x,this.y=a.detail.y,this.width=a.detail.width,this.height=a.detail.height,this.renderCover()},this.handleFile=(a)=>{if(0<a.target.files.length){let b=URL.createObjectURL(a.target.files[0]);this.blobs.push(b),this.img=document.createElement("img"),this.img.onload=()=>{this.cropper.reset().replace(b),this.fileLoaded=!0},this.img.src=b}},this.handleText=(a)=>{this.text=a.target.value,this.renderCover()},this.handleSave=()=>{let a=document.createElement("canvas");a.width=800,a.height=800;let b=a.getContext("2d");b.drawImage(this.img,this.x,this.y,this.width,this.height,0,0,800,800),b._blurRect(0,704,616,96,1,2),b._blurRect(671,652,129,148,1,2),b.drawImage(this.cover,0,517,800,283),b.font="42px MuseoBlack",b.fillStyle="#2d2d2d",b.fillText(this.text,34,764),a.toBlob((a)=>{c.i(r.saveAs)(a,"cover.png")})},b}componentDidMount(){this.initCanvas(),this.initCover()}componentWillUnmount(){this.blobs.forEach((a)=>{URL.revokeObjectURL(a)})}renderCover(){this.ctx.clearRect(0,0,500,500),this.ctx.drawImage(this.img,this.x,this.y,this.width,this.height,0,0,500,500),this.ctx._blurRect(0,439,400,61,1,2),this.ctx._blurRect(419,404,70,80,1,2),this.ctx.drawImage(this.cover,0,323,500,177),this.ctx.font="32px MuseoBlack",this.ctx.fillStyle="#2d2d2d",this.ctx.fillText(this.text,14,480)}render(){return o.a.createElement(i.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},o.a.createElement("div",{className:"container-fluid"},o.a.createElement(i.a,{gutter:32},o.a.createElement(k.a,{span:12,className:"cover"},o.a.createElement("canvas",{ref:(a)=>this.canvas=a,id:"canvas",width:"500",height:"500"})),o.a.createElement(k.a,{span:12},o.a.createElement(q.a,{className:"cropper",ref:(a)=>this.cropper=a,aspectRatio:1,dragMode:"move",viewMode:1,zoomable:!1,guides:!1,crop:this.onCrop}))),o.a.createElement(i.a,{type:"flex",justify:"center"},o.a.createElement(z,{onFile:this.handleFile,onText:this.handleText,onSave:this.handleSave}))))}}b.a=y;class z extends n.Component{constructor(a){super(a),this.handleFile=(a)=>{0<a.target.files.length&&(this.setState({fileLoaded:!0}),this.props.onFile(a))},this.handleText=(a)=>{this.props.onText(a)},this.handleSave=()=>{this.props.onSave()},this.state={fileLoaded:!1}}componentDidMount(){this.file.addEventListener("change",this.handleFile)}render(){return o.a.createElement(m.a,{className:"output form-cover"},o.a.createElement(x,null,o.a.createElement(g.a,{style:{height:"100%"},type:"file",ref:(a)=>a?this.file=a.refs.input:null,className:"sharp",addonAfter:"\u041E\u0431\u043B\u043E\u0436\u043A\u0430"})),o.a.createElement(x,null,o.a.createElement(g.a,{type:"text",id:"name",placeholder:"\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0442\u0438\u043F",className:"sharp","aria-describedby":"basic-addon2",disabled:!this.state.fileLoaded,onChange:this.handleText,addonAfter:"\u0422\u0438\u043F \u0430\u043B\u044C\u0431\u043E\u043C\u0430"})),o.a.createElement(x,null,o.a.createElement(i.a,{type:"flex",justify:"center"},o.a.createElement(e.a,{disabled:!this.state.fileLoaded,onClick:this.handleSave},"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"))))}}},211:function(a,b,c){"use strict";b.a=function(){return g.a.createElement(e.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},g.a.createElement("img",{src:i.a,className:"img-fluid"}))};var d=c(56),e=c.n(d),f=c(0),g=c.n(f),h=c(416),i=c.n(h)},212:function(a,b,c){"use strict";var d=c(177),e=c.n(d),f=c(56),g=c.n(f),h=c(118),i=c.n(h),j=c(107),k=c.n(j),l=c(115),m=c.n(l),n=c(110),o=c.n(n),p=c(0),q=c.n(p),r=c(287),s=c.n(r),t=c(216);const u=o.a.Item,v=m.a.Group;class w extends p.Component{constructor(a){super(a),this.parseJSON=(a)=>a.json(),this.handleChangeToken=(a)=>{this.setState({token:a.target.value,tokenValid:/access_token=(.+)&expires_in/.test(a.target.value)})},this.handleURL=(a)=>{this.setState({url:a.target.value})},this.setInfo=(a,b)=>{this.setState({info:{type:a,message:b}})},this.handleLink=()=>{this.setInfo("","");const a=this.state.token,b=this.file;if(0==b.files.length&&0==this.state.url.length)return this.setInfo("error","\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D \u0444\u0430\u0439\u043B \u0438\u043B\u0438 \u043D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E \u043F\u043E\u043B\u0435 \u044E\u0440\u043B"),!1;const[,c]=/access_token=(.+)&expires_in/.exec(a);var d=new FormData,e=/pu\.vk\.com\/c(\d+)\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)&api=1/i,f=/cs(\d+)\.vk\.com\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)/i;this.setInfo("info","\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435"),s()(`https://api.vk.com/method/docs.getUploadServer?v=5.54&access_token=${c}&type=graffiti`).then(this.checkStatusP).then(this.parseJSON).then((a)=>{var g=e.test(a.response.upload_url),[,h,c,i,j]=(g&&e||f).exec(a.response.upload_url);return(d.append("c",h),d.append("mid",c),d.append("hash",i),d.append("rhash",j),0<b.files.length)?(d.append("file",b.files[0]),fetch("https://ga2mer.cf/vkgraffiti/upload_by_file",{method:"POST",body:d}).then(this.checkStatus).then(this.parseJSON)):this.state.url?(d.append("url",this.state.url),fetch("https://ga2mer.cf/vkgraffiti/upload_by_url",{body:d,method:"POST"}).then(this.checkStatus).then(this.parseJSON)):void 0}).then((a)=>s()(`https://api.vk.com/method/docs.save?v=5.54&access_token=${c}&file=${a.file}`).then(this.parseJSON)).then((a)=>{var b=a.response[0],c=`https://vk.com/doc${b.owner_id}_${b.id}`;this.setInfo("success",c)}).catch((a)=>{return a instanceof t.a?this.setInfo("error",a.message):void this.setInfo("error",a.message)})},this.handleClearFile=()=>{this.file.value=""},this.handleCopyLink=()=>{this.linkInput.select(),document.execCommand("Copy")},this.renderAlert=()=>{return"success"==this.state.info.type?q.a.createElement(u,null,q.a.createElement(v,null,q.a.createElement(m.a,{style:{width:"64%"},type:"text",ref:(a)=>a?this.linkInput=a.refs.input:null,className:"field sharp",readOnly:!0,onClick:this.handleSelectAll,defaultValue:this.state.info.message}),q.a.createElement(k.a,{type:"primary",size:"large",className:"button-left-sharp",onClick:this.handleCopyLink},"\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C"))):q.a.createElement("div",{className:"text-center"},this.state.info.message)},this.renderLabelText=(a)=>q.a.createElement("div",{className:"text-center"},a),this.state={token:"",tokenValid:!1,url:"",info:{type:"",message:""}}}checkStatus(a){return 200<=a.status&&300>a.status?a:a.json().then((a)=>{var b;if(a.message)b="File too large"==a.message&&"\u0420\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 4\u043C\u0431"||a.message;else if(a.error&&a.error.error_code)return i.a.reject(new t.a(a.error.error_msg,a.error.error_code));return i.a.reject(new Error(b))})}checkStatusP(a){return a.json().then((b)=>{if(b.response)return a;return b.error&&b.error.error_code?i.a.reject(new t.a(b.error.error_msg,b.error.error_code)):b.error?i.a.reject(new Error(b.error.error_msg)):void 0})}handleGetToken(){window.open("https://oauth.vk.com/authorize?client_id=5553668&scope=docs&response_type=token")}handleSelectAll(a){a.target.setSelectionRange(0,a.target.value.length)}render(){return q.a.createElement(g.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},q.a.createElement("div",null,q.a.createElement("div",{className:"text-center"},"\u0417\u0434\u0435\u0441\u044C \u043A\u043E\u0433\u0434\u0430-\u043D\u0438\u0431\u0443\u0434\u044C \u0431\u0443\u0434\u0435\u0442 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"),q.a.createElement("div",null,q.a.createElement(o.a,{layout:"vertical",className:"form-nopadding"},q.a.createElement(u,{label:this.renderLabelText("\u0410\u0434\u0440\u0435\u0441 \u0441 access_token")},q.a.createElement(v,null,q.a.createElement(m.a,{style:{width:"70%"},type:"text",className:"field",value:this.state.token,onChange:this.handleChangeToken,placeholder:"https://oauth.vk.com/blank..."}),q.a.createElement(k.a,{type:"primary",size:"large",className:"button-left-sharp",onClick:this.handleGetToken},"\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C"))),q.a.createElement(u,{label:this.renderLabelText("\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435: png, jpg \u0438\u043B\u0438 gif")},q.a.createElement(v,null,q.a.createElement(m.a,{style:{width:"70%",height:"100%"},id:"file",className:"field",disabled:!this.state.tokenValid||0<this.state.url.length,ref:(a)=>a?this.file=a.refs.input:null,type:"file"}),q.a.createElement(k.a,{type:"primary",size:"large",className:"button-left-sharp wat",disabled:!this.state.tokenValid||0<this.state.url.length,onClick:this.handleClearFile},"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C"))),q.a.createElement("div",{className:"strike"},q.a.createElement("span",null,"\u0438\u043B\u0438 \u0441\u0441\u044B\u043B\u043A\u0443 \u043D\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435")),q.a.createElement(u,null,q.a.createElement(m.a,{className:"sharp",disabled:!this.state.tokenValid,type:"text",value:this.state.url,onChange:this.handleURL,placeholder:"e.g. http://i.imgur.com/cPuty2U.png"})),q.a.createElement("div",{className:"divider"}),q.a.createElement(g.a,{type:"flex",justify:"center"},q.a.createElement(k.a,{disabled:!this.state.tokenValid,onClick:this.handleLink},"\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0441\u0441\u044B\u043B\u043A\u0443")),this.state.info.type&&q.a.createElement("div",{className:"divider"}),this.state.info.type&&q.a.createElement(e.a,{className:"alert-center",message:this.renderAlert(),type:this.state.info.type})))))}}b.a=w},213:function(a,b,c){"use strict";var d=c(116),e=c.n(d),f=c(0),g=c.n(f),h=c(12);class i extends g.a.Component{constructor(...a){var b;return b=super(...a),this.handleClick=({key:a})=>{this.props.history.push(a)},b}render(){return g.a.createElement(e.a,{onClick:this.handleClick,theme:"dark",mode:"inline",selectedKeys:[location.pathname]},g.a.createElement(e.a.Item,{key:"/"},"Me"),g.a.createElement(e.a.Item,{key:"/graffiti"},"Graffiti"),g.a.createElement(e.a.Item,{key:"/cover"},"Cover"))}}i.propTypes={match:f.PropTypes.object.isRequired,location:f.PropTypes.object.isRequired,history:f.PropTypes.object.isRequired},b.a=c.i(h.d)(i)},214:function(a,b,c){"use strict";var d=c(213);c.d(b,"a",function(){return d.a})},215:function(a,b,c){"use strict";b.a=function(){return k.a.createElement(e.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},k.a.createElement(g.a,null,k.a.createElement("img",{src:m.a,className:"img-fluid"}),k.a.createElement(i.a,{mode:"horizontal",className:"no-border center-horizontal",selectedKeys:[]},k.a.createElement(i.a.Item,{key:"VK"},k.a.createElement("a",{target:"_blank",href:"https://vk.com/ga2mer_o_o"},"VK")),k.a.createElement(i.a.Item,{key:"Twitter"},k.a.createElement("a",{target:"_blank",href:"https://twitter.com/ga2mer_ru"},"Twitter")))))};var d=c(56),e=c.n(d),f=c(108),g=c.n(f),h=c(116),i=c.n(h),j=c(0),k=c.n(j),l=c(415),m=c.n(l)},216:function(a,b){"use strict";class c extends Error{constructor(a,b){super(),this.name="VKError",this.message=a,this.error_code=b,this.stack=new Error().stack}}b.a=c},217:function(){!function(a){"use strict";function b(a,c,d,e){var f,h,i,j,k,l,g,b=0.3086*(1-e),m=0.6094*(1-e),n=0.082*(1-e);for(i=0;i<d;i++)for(j=i*(c<<2),h=0;h<c;h++)f=j+(h<<2),k=a[f],l=a[f+1],g=a[f+2],a[f]=(b+e)*k+m*l+n*g,a[f+1]=b*k+(m+e)*l+n*g,a[f+2]=b*k+m*l+(n+e)*g}function c(a,c,i,h,j){var k=new Uint8Array(4*(c*i));d(a,k,c,i,h),f(k,a,c,i,h),e(a,k,c,i,h),g(k,a,c,i,h),j!==void 0&&1!==j&&b(a,c,i,j)}function d(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;for(g=0;g<d;g++){for(k=0,l=0,m=0,n=0,h=g*(c<<2),f=0;f<e;f++)i=h+(f<<2),k+=a[i],l+=a[i+1],m+=a[i+2],n+=a[i+3],b[i]=0|k/(f+1),b[i+1]=0|l/(f+1),b[i+2]=0|m/(f+1),b[i+3]=0|n/(f+1);for(;f<c;f++)i=h+(f<<2),j=i-(e<<2),b[i]=0|k/e,b[i+1]=0|l/e,b[i+2]=0|m/e,b[i+3]=0|n/e,k+=a[i]-a[j],l+=a[i+1]-a[j+1],m+=a[i+2]-a[j+2],n+=a[i+3]-a[j+3]}}function e(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;for(g=0;g<d;g++){for(k=0,l=0,m=0,n=0,h=g*(c<<2),f=c-1;f>=c-e;f--)i=h+(f<<2),k+=a[i],l+=a[i+1],m+=a[i+2],n+=a[i+3],b[i]=0|k/(c-f),b[i+1]=0|l/(c-f),b[i+2]=0|m/(c-f),b[i+3]=0|n/(c-f);for(;0<=f;f--)i=h+(f<<2),j=i+(e<<2),b[i]=0|k/e,b[i+1]=0|l/e,b[i+2]=0|m/e,b[i+3]=0|n/e,k+=a[i]-a[j],l+=a[i+1]-a[j+1],m+=a[i+2]-a[j+2],n+=a[i+3]-a[j+3]}}function f(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=c<<2;for(f=0;f<c;f++){for(k=0,l=0,m=0,n=0,h=f<<2,g=0;g<e;g++)i=h+g*o,k+=a[i],l+=a[i+1],m+=a[i+2],n+=a[i+3],b[i]=0|k/(g+1),b[i+1]=0|l/(g+1),b[i+2]=0|m/(g+1),b[i+3]=0|n/(g+1);for(;g<d;g++)i=h+g*o,j=i-o*e,b[i]=0|k/e,b[i+1]=0|l/e,b[i+2]=0|m/e,b[i+3]=0|n/e,k+=a[i]-a[j],l+=a[i+1]-a[j+1],m+=a[i+2]-a[j+2],n+=a[i+3]-a[j+3]}}function g(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=c<<2;for(f=0;f<c;f++){for(k=0,l=0,m=0,n=0,h=f<<2,g=d-1;g>=d-e;g--)i=h+g*o,k+=a[i],l+=a[i+1],m+=a[i+2],n+=a[i+3],b[i]=0|k/(d-g),b[i+1]=0|l/(d-g),b[i+2]=0|m/(d-g),b[i+3]=0|n/(d-g);for(;0<=g;g--)i=h+g*o,j=i+o*e,b[i]=0|k/e,b[i+1]=0|l/e,b[i+2]=0|m/e,b[i+3]=0|n/e,k+=a[i]-a[j],l+=a[i+1]-a[j+1],m+=a[i+2]-a[j+2],n+=a[i+3]-a[j+3]}}var i=document.createElement("canvas");i.width=screen.width,i.height=screen.height;var j=i.getContext("2d");a.CanvasRenderingContext2D.prototype._blurRect=function(a,b,d,e,f,g){var h=Math.max,k=this,l=k.canvas,m=0|d,n=0|e,o=0|a,p=0|b;f=32*(0|f),f=Math.min(h(f,32),256);var q=h(0,0|Math.log(f)/0.6931471805599453-3),r=f>>>q,s=l.width>>>q,t=l.height>>>q;j.drawImage(l,0,0,s,t);var u=j.getImageData(0,0,s,t);return c(u.data,s,t,r,g),j.putImageData(u,0,0),j.drawImage(i,0,0,s,t,0,0,l.width,l.height),k.drawImage(i,o,p,m,n,o,p,m,n),k}}(window)},275:function(){},414:function(a,b,c){a.exports=c.p+"lossy_v2.png"},415:function(a,b,c){a.exports=c.p+"nagisa.png"},416:function(a,b,c){a.exports=c.p+"ram.png"},420:function(a,b,c){a.exports=c(171)}},[420]);