var _Mathmax=Math.max;webpackJsonp([0],{169:function(a,d,f){f(114).default=f(225),f(209)},209:function(a,d,f){"use strict";Object.defineProperty(d,"__esModule",{value:!0});var k=f(186),l=f.n(k),m=f(272),n=f.n(m),o=f(0),p=f.n(o),q=f(20),s=f.n(q),t=f(149),u=f.n(t),v=f(384),z=f(213),A=f(214),B=f(212),C=f(210),D=f(211);u.a.useFiber=!0;const{Sider:E,Content:F}=l.a;f.i(q.render)(p.a.createElement(v.a,null,p.a.createElement(l.a,{className:"layout-center"},p.a.createElement(E,{collapsible:!0},p.a.createElement(z.a,null)),p.a.createElement(l.a,null,p.a.createElement(F,null,p.a.createElement(v.b,null,p.a.createElement(v.c,{path:"/",exact:!0,component:A.a}),p.a.createElement(v.c,{path:"/graffiti",component:B.a}),p.a.createElement(v.c,{path:"/cover",component:C.a}),p.a.createElement(v.c,{component:D.a})))))),document.querySelector("#root"))},210:function(a,d,f){"use strict";var k=f(106),l=f.n(k),m=f(111),n=f.n(m),o=f(40),p=f.n(o),q=f(69),s=f.n(q),t=f(108),u=f.n(t),v=f(0),z=f.n(v),A=f(316),B=f.n(A),C=f(285),D=f.n(C),E=f(410),F=f.n(E),G=f(216),H=f.n(G);const I=u.a.Item;class J extends v.Component{constructor(...L){var M;return M=super(...L),this.x=0,this.y=0,this.width=0,this.height=0,this.text="",this.fileLoaded=!1,this.blobs=[],this.initCanvas=()=>{this.ctx=this.canvas.getContext("2d")},this.initCover=()=>{this.cover=new Image,this.cover.onload=()=>{this.ctx.drawImage(this.cover,0,323,500,177),this.fileLoaded&&this.renderCover()},this.cover.src=F.a},this.onCrop=(N)=>{this.x=N.detail.x,this.y=N.detail.y,this.width=N.detail.width,this.height=N.detail.height,this.renderCover()},this.handleFile=(N)=>{if(0<N.target.files.length){let O=URL.createObjectURL(N.target.files[0]);this.blobs.push(O),this.img=document.createElement("img"),this.img.onload=()=>{this.cropper.reset().replace(O),this.fileLoaded=!0},this.img.src=O}},this.handleText=(N)=>{this.text=N.target.value,this.renderCover()},this.handleSave=()=>{let N=document.createElement("canvas");N.width=800,N.height=800;let O=N.getContext("2d");O.drawImage(this.img,this.x,this.y,this.width,this.height,0,0,800,800),O._blurRect(0,704,616,96,1,2),O._blurRect(671,652,129,148,1,2),O.drawImage(this.cover,0,517,800,283),O.font="42px MuseoBlack",O.fillStyle="#2d2d2d",O.fillText(this.text,34,764),N.toBlob((P)=>{f.i(C.saveAs)(P,"cover.png")})},M}componentDidMount(){this.initCanvas(),this.initCover()}componentWillUnmount(){this.blobs.forEach((L)=>{URL.revokeObjectURL(L)})}renderCover(){this.ctx.clearRect(0,0,500,500),this.ctx.drawImage(this.img,this.x,this.y,this.width,this.height,0,0,500,500),this.ctx._blurRect(0,439,400,61,1,2),this.ctx._blurRect(419,404,70,80,1,2),this.ctx.drawImage(this.cover,0,323,500,177),this.ctx.font="32px MuseoBlack",this.ctx.fillStyle="#2d2d2d",this.ctx.fillText(this.text,14,480)}render(){return z.a.createElement(p.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},z.a.createElement("div",{className:"container-fluid"},z.a.createElement(p.a,{gutter:32},z.a.createElement(s.a,{span:12,className:"cover"},z.a.createElement("canvas",{ref:(L)=>this.canvas=L,id:"canvas",width:"500",height:"500"})),z.a.createElement(s.a,{span:12},z.a.createElement(B.a,{className:"cropper",ref:(L)=>this.cropper=L,aspectRatio:1,dragMode:"move",viewMode:1,zoomable:!1,guides:!1,crop:this.onCrop}))),z.a.createElement(p.a,{type:"flex",justify:"center"},z.a.createElement(K,{onFile:this.handleFile,onText:this.handleText,onSave:this.handleSave}))))}}d.a=J;class K extends v.Component{constructor(L){super(L),this.handleFile=(M)=>{0<M.target.files.length&&(this.setState({fileLoaded:!0}),this.props.onFile(M))},this.handleText=(M)=>{this.props.onText(M)},this.handleSave=()=>{this.props.onSave()},this.state={fileLoaded:!1}}componentDidMount(){this.file.addEventListener("change",this.handleFile)}render(){return z.a.createElement(u.a,{className:"output form-cover"},z.a.createElement(I,null,z.a.createElement(n.a,{style:{height:"100%"},type:"file",ref:(L)=>L?this.file=L.refs.input:null,className:"sharp",addonAfter:"\u041E\u0431\u043B\u043E\u0436\u043A\u0430"})),z.a.createElement(I,null,z.a.createElement(n.a,{type:"text",id:"name",placeholder:"\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0442\u0438\u043F",className:"sharp","aria-describedby":"basic-addon2",disabled:!this.state.fileLoaded,onChange:this.handleText,addonAfter:"\u0422\u0438\u043F \u0430\u043B\u044C\u0431\u043E\u043C\u0430"})),z.a.createElement(I,null,z.a.createElement(p.a,{type:"flex",justify:"center"},z.a.createElement(l.a,{disabled:!this.state.fileLoaded,onClick:this.handleSave},"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"))))}}},211:function(a,d,f){"use strict";var l=f(40),m=f.n(l),n=f(0),o=f.n(n),p=f(412),q=f.n(p);d.a=function(){return o.a.createElement(m.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},o.a.createElement("img",{src:q.a,className:"img-fluid"}))}},212:function(a,d,f){"use strict";var k=f(175),l=f.n(k),m=f(40),n=f.n(m),o=f(114),p=f.n(o),q=f(106),s=f.n(q),t=f(111),u=f.n(t),v=f(108),z=f.n(v),A=f(0),B=f.n(A),C=f(7),D=f.n(C),E=f(284),F=f.n(E),G=f(215);const H=z.a.Item,I=u.a.Group;class J extends A.Component{constructor(K){super(K),this.parseJSON=(L)=>L.json(),this.handleChangeToken=(L)=>{this.setState({token:L.target.value,tokenValid:/access_token=(.+)&expires_in/.test(L.target.value)})},this.handleURL=(L)=>{this.setState({url:L.target.value})},this.setInfo=(L,M)=>{this.setState({info:{type:L,message:M}})},this.handleLink=()=>{this.setInfo("","");const L=this.state.token,M=this.file;if(0==M.files.length&&0==this.state.url.length)return this.setInfo("error","\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D \u0444\u0430\u0439\u043B \u0438\u043B\u0438 \u043D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E \u043F\u043E\u043B\u0435 \u044E\u0440\u043B"),!1;const[,N]=/access_token=(.+)&expires_in/.exec(L);var O=new FormData;O.append("file",M.files[0]);var P=/pu\.vk\.com\/c(\d+)\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)&api=1/i,Q=/cs(\d+)\.vk\.com\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)/i;this.setInfo("info","\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435"),F()(`https://api.vk.com/method/docs.getUploadServer?v=5.54&access_token=${N}&type=graffiti`).then(this.checkStatusP).then(this.parseJSON).then((R)=>{var S=P.test(R.response.upload_url),[,U,V,W,X]=(S&&P||Q).exec(R.response.upload_url);if(0<M.files.length)return fetch(`https://akg.moe/vkgraffiti/upload_by_file?c=${U}&mid=${V}&hash=${W}&rhash=${X}`,{method:"POST",body:O}).then(this.checkStatus).then(this.parseJSON);return this.state.url?fetch(`https://akg.moe/vkgraffiti/upload_by_url?url=${this.state.url}&c=${U}&mid=${V}&hash=${W}&rhash=${X}`,{method:"POST"}).then(this.checkStatus).then(this.parseJSON):void 0}).then((R)=>F()(`https://api.vk.com/method/docs.save?v=5.54&access_token=${N}&file=${R.file}`).then(this.parseJSON)).then((R)=>{var S=R.response[0],T=`https://vk.com/doc${S.owner_id}_${S.id}`;this.setInfo("success",T)}).catch((R)=>{return R instanceof G.a?this.setInfo("error",R.message):void this.setInfo("error",R.message)})},this.handleClearFile=()=>{this.file.value=""},this.handleCopyLink=()=>{this.linkInput.select(),document.execCommand("Copy")},this.renderAlert=()=>{return"success"==this.state.info.type?B.a.createElement(H,null,B.a.createElement(I,null,B.a.createElement(u.a,{style:{width:"64%"},type:"text",ref:(L)=>L?this.linkInput=L.refs.input:null,className:"field sharp",readOnly:!0,onClick:this.handleSelectAll,defaultValue:this.state.info.message}),B.a.createElement(s.a,{type:"primary",size:"large",className:"button-left-sharp",onClick:this.handleCopyLink},"\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C"))):B.a.createElement("div",{className:"text-center"},this.state.info.message)},this.renderLabelText=(L)=>B.a.createElement("div",{className:"text-center"},L),this.state={token:"",tokenValid:!1,url:"",info:{type:"",message:""}}}checkStatus(K){return 200<=K.status&&300>K.status?K:K.json().then((L)=>{var M;if(L.message)M="File too large"==L.message&&"\u0420\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 4\u043C\u0431"||L.message;else if(L.error&&L.error.error_code)return p.a.reject(new G.a(L.error.error_msg,L.error.error_code));return p.a.reject(new Error(M))})}checkStatusP(K){return K.json().then((L)=>{if(L.response)return K;return L.error&&L.error.error_code?p.a.reject(new G.a(L.error.error_msg,L.error.error_code)):L.error?p.a.reject(new Error(L.error.error_msg)):void 0})}handleGetToken(){window.open("https://oauth.vk.com/authorize?client_id=5553668&scope=docs&response_type=token")}handleSelectAll(K){K.target.setSelectionRange(0,K.target.value.length)}render(){return B.a.createElement(n.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},B.a.createElement("div",null,B.a.createElement("div",{className:"text-center"},"\u0417\u0434\u0435\u0441\u044C \u043A\u043E\u0433\u0434\u0430-\u043D\u0438\u0431\u0443\u0434\u044C \u0431\u0443\u0434\u0435\u0442 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"),B.a.createElement("div",null,B.a.createElement(z.a,{layout:"vertical",className:"form-nopadding"},B.a.createElement(H,{label:this.renderLabelText("\u0410\u0434\u0440\u0435\u0441 \u0441 access_token")},B.a.createElement(I,null,B.a.createElement(u.a,{style:{width:"70%"},type:"text",className:"field",value:this.state.token,onChange:this.handleChangeToken,placeholder:"https://oauth.vk.com/blank..."}),B.a.createElement(s.a,{type:"primary",size:"large",className:"button-left-sharp",onClick:this.handleGetToken},"\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C"))),B.a.createElement(H,{label:this.renderLabelText("\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435: png, jpg \u0438\u043B\u0438 gif")},B.a.createElement(I,null,B.a.createElement(u.a,{style:{width:"70%",height:"100%"},id:"file",className:"field",disabled:!this.state.tokenValid||0<this.state.url.length,ref:(K)=>K?this.file=K.refs.input:null,type:"file"}),B.a.createElement(s.a,{type:"primary",size:"large",className:"button-left-sharp wat",disabled:!this.state.tokenValid||0<this.state.url.length,onClick:this.handleClearFile},"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C"))),B.a.createElement("div",{className:"strike"},B.a.createElement("span",null,"\u0438\u043B\u0438 \u0441\u0441\u044B\u043B\u043A\u0443 \u043D\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435")),B.a.createElement(H,null,B.a.createElement(u.a,{className:"sharp",disabled:!this.state.tokenValid,type:"text",value:this.state.url,onChange:this.handleURL,placeholder:"e.g. http://i.imgur.com/cPuty2U.png"})),B.a.createElement("div",{className:"divider"}),B.a.createElement(n.a,{type:"flex",justify:"center"},B.a.createElement(s.a,{disabled:!this.state.tokenValid,onClick:this.handleLink},"\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0441\u0441\u044B\u043B\u043A\u0443")),this.state.info.type&&B.a.createElement("div",{className:"divider"}),this.state.info.type&&B.a.createElement(l.a,{className:"alert-center",message:this.renderAlert(),type:this.state.info.type})))))}}d.a=J},213:function(a,d,f){"use strict";var k=f(112),l=f.n(k),m=f(0),n=f.n(m),o=f(11);class p extends n.a.Component{constructor(...q){var s;return s=super(...q),this.handleClick=({key:t})=>{this.props.history.push(t)},s}render(){return n.a.createElement(l.a,{onClick:this.handleClick,theme:"dark",mode:"inline",selectedKeys:[location.pathname]},n.a.createElement(l.a.Item,{key:"/"},"Me"),n.a.createElement(l.a.Item,{key:"/graffiti"},"Graffiti"),n.a.createElement(l.a.Item,{key:"/cover"},"Cover"))}}p.propTypes={match:m.PropTypes.object.isRequired,location:m.PropTypes.object.isRequired,history:m.PropTypes.object.isRequired},d.a=f.i(o.d)(p)},214:function(a,d,f){"use strict";var l=f(40),m=f.n(l),n=f(69),o=f.n(n),p=f(112),q=f.n(p),s=f(0),t=f.n(s),u=f(411),v=f.n(u);d.a=function(){return t.a.createElement(m.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},t.a.createElement(o.a,null,t.a.createElement("img",{src:v.a,className:"img-fluid"}),t.a.createElement(q.a,{mode:"horizontal",className:"no-border center-horizontal",selectedKeys:[]},t.a.createElement(q.a.Item,{key:"VK"},t.a.createElement("a",{target:"_blank",href:"https://vk.com/ga2mer_o_o"},"VK")),t.a.createElement(q.a.Item,{key:"Twitter"},t.a.createElement("a",{target:"_blank",href:"https://twitter.com/ga2mer_ru"},"Twitter")))))}},215:function(a,d){"use strict";class k extends Error{constructor(l,m){super(),this.name="VKError",this.message=l,this.error_code=m,this.stack=new Error().stack}}d.a=k},216:function(){!function(f){"use strict";function k(u,v,z,A){var C,D,E,F,G=0.3086*(1-A),H=0.6094*(1-A),I=0.082*(1-A),J,K,L;for(E=0;E<z;E++)for(F=E*(v<<2),D=0;D<v;D++)C=F+(D<<2),J=u[C],K=u[C+1],L=u[C+2],u[C]=(G+A)*J+H*K+I*L,u[C+1]=G*J+(H+A)*K+I*L,u[C+2]=G*J+H*K+(I+A)*L}function l(u,v,z,A,B){var C=new Uint8Array(4*(v*z));m(u,C,v,z,A),o(C,u,v,z,A),n(u,C,v,z,A),p(C,u,v,z,A),B!==void 0&&1!==B&&k(u,v,z,B)}function m(u,v,z,A,B){var C,D,E,F,G,J,K,L,M;for(D=0;D<A;D++){for(J=0,K=0,L=0,M=0,E=D*(z<<2),C=0;C<B;C++)F=E+(C<<2),J+=u[F],K+=u[F+1],L+=u[F+2],M+=u[F+3],v[F]=0|J/(C+1),v[F+1]=0|K/(C+1),v[F+2]=0|L/(C+1),v[F+3]=0|M/(C+1);for(;C<z;C++)F=E+(C<<2),G=F-(B<<2),v[F]=0|J/B,v[F+1]=0|K/B,v[F+2]=0|L/B,v[F+3]=0|M/B,J+=u[F]-u[G],K+=u[F+1]-u[G+1],L+=u[F+2]-u[G+2],M+=u[F+3]-u[G+3]}}function n(u,v,z,A,B){var C,D,E,F,G,J,K,L,M;for(D=0;D<A;D++){for(J=0,K=0,L=0,M=0,E=D*(z<<2),C=z-1;C>=z-B;C--)F=E+(C<<2),J+=u[F],K+=u[F+1],L+=u[F+2],M+=u[F+3],v[F]=0|J/(z-C),v[F+1]=0|K/(z-C),v[F+2]=0|L/(z-C),v[F+3]=0|M/(z-C);for(;0<=C;C--)F=E+(C<<2),G=F+(B<<2),v[F]=0|J/B,v[F+1]=0|K/B,v[F+2]=0|L/B,v[F+3]=0|M/B,J+=u[F]-u[G],K+=u[F+1]-u[G+1],L+=u[F+2]-u[G+2],M+=u[F+3]-u[G+3]}}function o(u,v,z,A,B){var C,D,E,F,G,I=z<<2,K,L,M,N;for(C=0;C<z;C++){for(K=0,L=0,M=0,N=0,E=C<<2,D=0;D<B;D++)F=E+D*I,K+=u[F],L+=u[F+1],M+=u[F+2],N+=u[F+3],v[F]=0|K/(D+1),v[F+1]=0|L/(D+1),v[F+2]=0|M/(D+1),v[F+3]=0|N/(D+1);for(;D<A;D++)F=E+D*I,G=F-I*B,v[F]=0|K/B,v[F+1]=0|L/B,v[F+2]=0|M/B,v[F+3]=0|N/B,K+=u[F]-u[G],L+=u[F+1]-u[G+1],M+=u[F+2]-u[G+2],N+=u[F+3]-u[G+3]}}function p(u,v,z,A,B){var C,D,E,F,G,I=z<<2,K,L,M,N;for(C=0;C<z;C++){for(K=0,L=0,M=0,N=0,E=C<<2,D=A-1;D>=A-B;D--)F=E+D*I,K+=u[F],L+=u[F+1],M+=u[F+2],N+=u[F+3],v[F]=0|K/(A-D),v[F+1]=0|L/(A-D),v[F+2]=0|M/(A-D),v[F+3]=0|N/(A-D);for(;0<=D;D--)F=E+D*I,G=F+I*B,v[F]=0|K/B,v[F+1]=0|L/B,v[F+2]=0|M/B,v[F+3]=0|N/B,K+=u[F]-u[G],L+=u[F+1]-u[G+1],M+=u[F+2]-u[G+2],N+=u[F+3]-u[G+3]}}var s=document.createElement("canvas");s.width=screen.width,s.height=screen.height;var t=s.getContext("2d");f.CanvasRenderingContext2D.prototype._blurRect=function(u,v,z,A,B,C){var D=this,E=D.canvas,F=0|z,G=0|A,H=0|u,I=0|v;B=32*(0|B),B=Math.min(_Mathmax(B,32),256);var J=_Mathmax(0,0|Math.log(B)/0.6931471805599453-3),K=B>>>J,L=E.width>>>J,M=E.height>>>J;t.drawImage(E,0,0,L,M);var N=t.getImageData(0,0,L,M);return l(N.data,L,M,K,C),t.putImageData(N,0,0),t.drawImage(s,0,0,L,M,0,0,E.width,E.height),D.drawImage(s,H,I,F,G,H,I,F,G),D}}(window)},272:function(){},410:function(a,d,f){a.exports=f.p+"lossy_v2.png"},411:function(a,d,f){a.exports=f.p+"nagisa.png"},412:function(a,d,f){a.exports=f.p+"ram.png"},416:function(a,d,f){a.exports=f(169)}},[416]);