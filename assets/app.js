webpackJsonp([0],{167:function(e,t,a){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{"default":e}}function r(e){return l["default"].createElement("div",{className:"app"},l["default"].createElement(u["default"],{currentRoute:e.location.pathname}),e.children)}a(222);var n=a(4),l=t(n),s=a(243),o=a(134),i=a(170),u=t(i),c=a(171),d=t(c),f=a(169),m=t(f),p=a(168),h=t(p);e.Promise=a(178),(0,s.render)(l["default"].createElement(o.Router,{history:o.browserHistory},l["default"].createElement(o.Route,{path:"/",component:r},l["default"].createElement(o.IndexRoute,{component:d["default"]}),l["default"].createElement(o.Route,{path:"graffiti",component:m["default"]}),l["default"].createElement(o.Route,{path:"*",component:h["default"]}))),document.querySelector("#root"))}).call(t,a(166))},168:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(){return s["default"].createElement("div",{className:"container center-text",style:{maxWidth:"450px"}},s["default"].createElement("img",{src:i["default"],className:"img-fluid"}))}t.__esModule=!0,t["default"]=n;var l=a(4),s=r(l),o=a(331),i=r(o)},169:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var n=a(175),l=r(n),s=a(101),o=r(s),i=a(103),u=r(i),c=a(102),d=r(c),f=a(4),m=r(f),p=a(236),h=r(p),v=a(172),g=r(v),k=function(e){function t(a){(0,o["default"])(this,t);var r=(0,u["default"])(this,e.call(this,a));return r.parseJSON=function(e){return e.json()},r.handleChangeToken=function(e){r.setState({token:e.target.value,tokenValid:/access_token=(.+)&expires_in/.test(e.target.value)})},r.handleURL=function(e){r.setState({url:e.target.value})},r.handleLink=function(){r.setState({error:"",message:"",link:""});var e=r.state.token,t=r.file;if(0==t.files.length&&0==r.state.url.length)return r.setState({error:"Не выбран файл или не заполнено поле юрл"}),!1;var a=/access_token=(.+)&expires_in/.exec(e),n=a[1],l=new FormData;l.append("file",t.files[0]);var s=/pu\.vk\.com\/c(\d+)\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)&api=1/i,o=/cs(\d+)\.vk\.com\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)/i;r.setState({message:"Загрузка изображения, подождите"}),(0,h["default"])("https://api.vk.com/method/docs.getUploadServer?v=5.54&access_token="+n+"&type=graffiti").then(r.checkStatusP).then(r.parseJSON).then(function(e){var a=s.test(e.response.upload_url),n=a&&s||o,i=n.exec(e.response.upload_url),u=i[1],c=i[2],d=i[3],f=i[4];return t.files.length>0?fetch("https://akigami.ru/vkgraffiti/upload_by_file?c="+u+"&mid="+c+"&hash="+d+"&rhash="+f,{method:"POST",body:l}).then(r.checkStatus).then(r.parseJSON):r.state.url?fetch("https://akigami.ru/vkgraffiti/upload_by_url?url="+r.state.url+"&c="+u+"&mid="+c+"&hash="+d+"&rhash="+f,{method:"POST"}).then(r.checkStatus).then(r.parseJSON):void 0}).then(function(e){return(0,h["default"])("https://api.vk.com/method/docs.save?v=5.54&access_token="+n+"&file="+e.file).then(r.parseJSON)}).then(function(e){var t=e.response[0],a="https://vk.com/doc"+t.owner_id+"_"+t.id;r.setState({link:a,err:"",message:""})})["catch"](function(e){return e instanceof g["default"]?r.setState({error:e.message,link:"",message:""}):void r.setState({error:e.message,link:"",message:""})})},r.handleClearFile=function(){r.file.value=""},r.handleCopyLink=function(){r.copyToClipboard(r.state.link)},r.state={token:"",tokenValid:!1,url:"",error:"",link:"",message:""},r}return(0,d["default"])(t,e),t.prototype.checkStatus=function(e){return e.status>=200&&e.status<300?e:e.json().then(function(e){var t;if(e.message)t="File too large"==e.message&&"Размер файла превышает 4мб"||e.message;else if(e.error&&e.error.error_code)return l["default"].reject(new g["default"](e.error.error_msg,e.error.error_code));return l["default"].reject(new Error(t))})},t.prototype.checkStatusP=function(e){return e.json().then(function(t){return t.response?e:t.error&&t.error.error_code?l["default"].reject(new g["default"](t.error.error_msg,t.error.error_code)):t.error?l["default"].reject(new Error(t.error.error_msg)):void 0})},t.prototype.handleGetToken=function(){window.open("https://oauth.vk.com/authorize?client_id=5553668&scope=docs&response_type=token")},t.prototype.handleSelectAll=function(e){e.target.setSelectionRange(0,e.target.value.length)},t.prototype.copyToClipboard=function(e){var t=document.createElement("input");t.style.position="fixed",t.style.opacity=0,t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},t.prototype.render=function(){var e=this;return m["default"].createElement("div",{className:"container"},m["default"].createElement("div",{className:"container center-text",style:{maxWidth:"450px"}},"Здесь когда-нибудь будет описание",m["default"].createElement("form",null,m["default"].createElement("label",{htmlFor:"token"},"Адрес с access_token"),m["default"].createElement("div",{className:"input-group"},m["default"].createElement("input",{id:"token",type:"text",className:"form-control sharp",value:this.state.token,onChange:this.handleChangeToken,placeholder:"https://oauth.vk.com/blank..."}),m["default"].createElement("span",{className:"input-group-btn"},m["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",onClick:this.handleGetToken},"Получить"))),m["default"].createElement("label",{htmlFor:"file"},"Изображение в формате: png, jpg или gif"),m["default"].createElement("div",{className:"input-group"},m["default"].createElement("input",{id:"file",className:"form-control sharp",disabled:!this.state.tokenValid||this.state.url.length>0,ref:function(t){return e.file=t},type:"file"}),m["default"].createElement("span",{className:"input-group-btn"},m["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",disabled:!this.state.tokenValid||this.state.url.length>0,onClick:this.handleClearFile},"Очистить"))),m["default"].createElement("div",{className:"strike"},m["default"].createElement("span",null,"или ссылку на изображение")),m["default"].createElement("input",{className:"form-control sharp",disabled:!this.state.tokenValid,type:"text",value:this.state.url,onKeyUp:this.handleURL,placeholder:"e.g. http://i.imgur.com/cPuty2U.png"}),m["default"].createElement("div",{className:"divider"}),m["default"].createElement("div",null,m["default"].createElement("button",{className:"btn btn-secondary sharp",type:"button",disabled:!this.state.tokenValid,onClick:this.handleLink},"Получить ссылку")),(this.state.error||this.state.message||this.state.link)&&m["default"].createElement("div",{className:"divider"}),this.state.error&&m["default"].createElement("div",{className:"alert alert-danger",role:"alert"},this.state.error),this.state.message&&m["default"].createElement("div",{className:"alert alert-info",role:"alert"},this.state.message),this.state.link&&m["default"].createElement("div",{className:"alert alert-success",role:"alert"},m["default"].createElement("div",{className:"input-group"},m["default"].createElement("input",{type:"text",className:"form-control sharp",readOnly:!0,onClick:this.handleSelectAll,defaultValue:this.state.link}),m["default"].createElement("span",{className:"input-group-btn"},m["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",onClick:this.handleCopyLink},"Скопировать")))))))},t}(f.Component);t["default"]=k},170:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.currentRoute;return s["default"].createElement("nav",{className:"navbar navbar-pills navbar-fixed-top",style:{background:"white"}},s["default"].createElement("ul",{className:"nav nav-pills navbar-nav"},s["default"].createElement("li",{className:(0,u["default"])({"nav-item":!0,active:"/"==t})},s["default"].createElement(o.Link,{className:"nav-link",to:"/"},"Me")),s["default"].createElement("li",{className:(0,u["default"])({"nav-item":!0,active:"/graffiti"==t})},s["default"].createElement(o.Link,{className:"nav-link",to:"/graffiti"},"Graffiti"))))}t.__esModule=!0,t["default"]=n;var l=a(4),s=r(l),o=a(134),i=a(179),u=r(i)},171:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(){return s["default"].createElement("div",{className:"vertical-center"},s["default"].createElement("div",{className:"container center-text",style:{maxWidth:"450px"}},s["default"].createElement("img",{src:i["default"],className:"img-fluid"}),s["default"].createElement("ul",{className:"links"},s["default"].createElement("li",null,s["default"].createElement("a",{href:"https://vk.com/ga2mer_o_o"},"VK")),s["default"].createElement("li",null,s["default"].createElement("a",{href:"https://twitter.com/ga2mer_ru"},"Twitter")))))}t.__esModule=!0,t["default"]=n;var l=a(4),s=r(l),o=a(330),i=r(o)},172:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var n=a(101),l=r(n),s=a(103),o=r(s),i=a(102),u=r(i),c=function(e){function t(a,r){(0,l["default"])(this,t);var n=(0,o["default"])(this,e.call(this));return n.name="VKError",n.message=a,n.error_code=r,n.stack=(new Error).stack,n}return(0,u["default"])(t,e),t}(Error);t["default"]=c},222:function(e,t){},330:function(e,t,a){e.exports=a.p+"nagisa.png"},331:function(e,t,a){e.exports=a.p+"ram.png"},332:function(e,t,a){e.exports=a(167)}},[332]);