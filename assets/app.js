webpackJsonp([0],{169:function(e,t,a){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return l["default"].createElement("div",{className:"app"},l["default"].createElement(c["default"],{currentRoute:e.location.pathname}),e.children)}a(223);var r=a(4),l=t(r),o=a(249),i=a(138),s=a(173),c=t(s),u=a(174),d=t(u),f=a(172),h=t(f),m=a(170),p=t(m),v=a(171),g=t(v);e.Promise=a(182),(0,o.render)(l["default"].createElement(i.Router,{history:i.browserHistory},l["default"].createElement(i.Route,{path:"/",component:n},l["default"].createElement(i.IndexRoute,{component:d["default"]}),l["default"].createElement(i.Route,{path:"graffiti",component:h["default"]}),l["default"].createElement(i.Route,{path:"cover",component:p["default"]}),l["default"].createElement(i.Route,{path:"*",component:g["default"]}))),document.querySelector("#root"))}).call(t,a(168))},170:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=a(62),l=n(r),o=a(64),i=n(o),s=a(63),c=n(s),u=a(4),d=n(u),f=a(247),h=n(f),m=a(238),p=a(330),v=n(p),g=a(331),E=n(g),y=a(332),k=n(y);a(176);var b=function(e){function t(){var a,n,r;(0,l["default"])(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];return a=n=(0,i["default"])(this,e.call.apply(e,[this].concat(s))),n.x=0,n.y=0,n.width=0,n.height=0,n.text="",n.fileLoaded=!1,n.initCanvas=function(){n.ctx=n.canvas.getContext("2d")},n.initCover=function(){n.cover=new Image,n.cover.onload=function(){n.ctx.drawImage(n.cover,0,323,500,177),n.fileLoaded&&n.renderCover()},n.cover.src=n.state.hires?v["default"]:n.state.v2?k["default"]:E["default"]},n.onCrop=function(e){n.x=e.x,n.y=e.y,n.width=e.width,n.height=e.height,n.renderCover()},n.handleFile=function(e){if(e.target.files.length>0){var t=URL.createObjectURL(e.target.files[0]);n.img=document.createElement("img"),n.img.src=t,n.cropper.reset().replace(t),n.fileLoaded=!0}},n.handleText=function(e){n.text=e.target.value,n.renderCover()},n.handleSave=function(){var e=document.createElement("canvas");e.width=800,e.height=800;var t=e.getContext("2d");t.drawImage(n.img,n.x,n.y,n.width,n.height,0,0,800,800),t._blurRect(0,704,616,96,1,2),t._blurRect(671,652,129,148,1,2),t.drawImage(n.cover,0,517,800,283),t.font="42px Roboto Medium",t.fillStyle="#2d2d2d",t.fillText(n.text,34,764),e.toBlob(function(e){(0,m.saveAs)(e,"cover.png")})},n.handleChangeQuality=function(e){n.setState({hires:e},function(){n.ctx.clearRect(0,0,500,500),n.initCover()})},r=a,(0,i["default"])(n,r)}return(0,c["default"])(t,e),t.prototype.componentDidMount=function(){this.state={hires:!1,v2:!0},this.initCanvas(),this.initCover()},t.prototype.renderCover=function(){this.ctx.clearRect(0,0,500,500),this.ctx.drawImage(this.img,this.x,this.y,this.width,this.height,0,0,500,500),this.ctx._blurRect(0,439,400,61,1,2),this.ctx._blurRect(419,404,70,80,1,2),this.ctx.drawImage(this.cover,0,323,500,177),this.ctx.font="32px Roboto Medium",this.ctx.fillStyle="#2d2d2d",this.ctx.fillText(this.text,14,480)},t.prototype.render=function(){var e=this;return d["default"].createElement("div",{className:"flex middle-container"},d["default"].createElement("div",{className:"container-fluid"},d["default"].createElement("div",{className:"row"},d["default"].createElement("div",{className:"col-sm-6"},d["default"].createElement("div",{className:"cover"},d["default"].createElement("canvas",{ref:function(t){return e.canvas=t},id:"canvas",width:"500",height:"500"}))),d["default"].createElement("div",{className:"col-sm-6"},d["default"].createElement(h["default"],{className:"cropper",ref:function(t){return e.cropper=t},aspectRatio:1,dragMode:"move",viewMode:1,zoomable:!1,guides:!1,crop:this.onCrop})),d["default"].createElement("div",{className:"col-sm-3"},d["default"].createElement(x,{onChangeQuality:this.handleChangeQuality,onFile:this.handleFile,onText:this.handleText,onSave:this.handleSave})))))},t}(u.Component);t["default"]=b;var x=function(e){function t(a){(0,l["default"])(this,t);var n=(0,i["default"])(this,e.call(this,a));return n.handleFile=function(e){e.target.files.length>0&&(n.setState({fileLoaded:!0}),n.props.onFile(e))},n.handleChangeQuality=function(){n.setState({hires:!n.state.hires}),n.props.onChangeQuality(!n.state.hires)},n.handleText=function(e){n.props.onText(e)},n.handleSave=function(){n.props.onSave()},n.state={fileLoaded:!1,hires:!1},n}return(0,c["default"])(t,e),t.prototype.render=function(){return d["default"].createElement("div",{className:"output"},d["default"].createElement("div",{className:"input-group"},d["default"].createElement("div",{className:"input-group-addon",id:"basic-addon2"},d["default"].createElement("input",{type:"checkbox",value:this.state.hires,onChange:this.handleChangeQuality})," "," HIRES"),d["default"].createElement("input",{type:"file",id:"file",className:"form-control","aria-describedby":"basic-addon2",onChange:this.handleFile}),d["default"].createElement("span",{className:"input-group-addon",id:"basic-addon2"},"Обложка")),d["default"].createElement("div",{className:"input-group"},d["default"].createElement("input",{type:"text",id:"name",placeholder:"Укажите тип",className:"form-control","aria-describedby":"basic-addon2",disabled:!this.state.fileLoaded,onChange:this.handleText}),d["default"].createElement("span",{className:"input-group-addon",id:"basic-addon2"},"Тип альбома")),d["default"].createElement("button",{id:"save",type:"button",className:"btn btn-secondary btn-block",disabled:!this.state.fileLoaded,onClick:this.handleSave},"Сохранить"))},t}(u.Component)},171:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(){return o["default"].createElement("div",{className:"container center-text",style:{maxWidth:"450px"}},o["default"].createElement("img",{src:s["default"],className:"img-fluid"}))}t.__esModule=!0,t["default"]=r;var l=a(4),o=n(l),i=a(334),s=n(i)},172:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=a(179),l=n(r),o=a(62),i=n(o),s=a(64),c=n(s),u=a(63),d=n(u),f=a(4),h=n(f),m=a(110),p=n(m),v=a(237),g=n(v),E=a(175),y=n(E),k=function(e){function t(a){(0,i["default"])(this,t);var n=(0,c["default"])(this,e.call(this,a));return n.parseJSON=function(e){return e.json()},n.handleChangeToken=function(e){n.setState({token:e.target.value,tokenValid:/access_token=(.+)&expires_in/.test(e.target.value)})},n.handleURL=function(e){n.setState({url:e.target.value})},n.setInfo=function(e,t){n.setState({info:{type:e,message:t}})},n.handleLink=function(){n.setInfo("","");var e=n.state.token,t=n.file;if(0==t.files.length&&0==n.state.url.length)return n.setInfo("error","Не выбран файл или не заполнено поле юрл"),!1;var a=/access_token=(.+)&expires_in/.exec(e),r=a[1],l=new FormData;l.append("file",t.files[0]);var o=/pu\.vk\.com\/c(\d+)\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)&api=1/i,i=/cs(\d+)\.vk\.com\/upload\.php\?act=add_doc&mid=(\d+)&aid=0&gid=0&type=graffiti&hash=([a-z0-9]+)&rhash=([a-z0-9]+)/i;n.setInfo("message","Загрузка изображения, подождите"),(0,g["default"])("https://api.vk.com/method/docs.getUploadServer?v=5.54&access_token="+r+"&type=graffiti").then(n.checkStatusP).then(n.parseJSON).then(function(e){var a=o.test(e.response.upload_url),r=a&&o||i,s=r.exec(e.response.upload_url),c=s[1],u=s[2],d=s[3],f=s[4];return t.files.length>0?fetch("https://akg.moe/vkgraffiti/upload_by_file?c="+c+"&mid="+u+"&hash="+d+"&rhash="+f,{method:"POST",body:l}).then(n.checkStatus).then(n.parseJSON):n.state.url?fetch("https://akg.moe/vkgraffiti/upload_by_url?url="+n.state.url+"&c="+c+"&mid="+u+"&hash="+d+"&rhash="+f,{method:"POST"}).then(n.checkStatus).then(n.parseJSON):void 0}).then(function(e){return(0,g["default"])("https://api.vk.com/method/docs.save?v=5.54&access_token="+r+"&file="+e.file).then(n.parseJSON)}).then(function(e){var t=e.response[0],a="https://vk.com/doc"+t.owner_id+"_"+t.id;n.setInfo("link",a)})["catch"](function(e){return e instanceof y["default"]?n.setInfo("error",e.message):void n.setInfo("error",e.message)})},n.handleClearFile=function(){n.file.value=""},n.handleCopyLink=function(){n.linkInput.select(),document.execCommand("Copy")},n.state={token:"",tokenValid:!1,url:"",info:{type:"",message:""}},n}return(0,d["default"])(t,e),t.prototype.checkStatus=function(e){return e.status>=200&&e.status<300?e:e.json().then(function(e){var t;if(e.message)t="File too large"==e.message&&"Размер файла превышает 4мб"||e.message;else if(e.error&&e.error.error_code)return l["default"].reject(new y["default"](e.error.error_msg,e.error.error_code));return l["default"].reject(new Error(t))})},t.prototype.checkStatusP=function(e){return e.json().then(function(t){return t.response?e:t.error&&t.error.error_code?l["default"].reject(new y["default"](t.error.error_msg,t.error.error_code)):t.error?l["default"].reject(new Error(t.error.error_msg)):void 0})},t.prototype.handleGetToken=function(){window.open("https://oauth.vk.com/authorize?client_id=5553668&scope=docs&response_type=token")},t.prototype.handleSelectAll=function(e){e.target.setSelectionRange(0,e.target.value.length)},t.prototype.render=function(){var e=this;return h["default"].createElement("div",{className:"container middle-container"},h["default"].createElement("div",{className:"container center-text",style:{maxWidth:"450px"}},"Здесь когда-нибудь будет описание",h["default"].createElement("form",null,h["default"].createElement("label",{htmlFor:"token"},"Адрес с access_token"),h["default"].createElement("div",{className:"input-group"},h["default"].createElement("input",{id:"token",type:"text",className:"form-control sharp",value:this.state.token,onChange:this.handleChangeToken,placeholder:"https://oauth.vk.com/blank..."}),h["default"].createElement("span",{className:"input-group-btn"},h["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",onClick:this.handleGetToken},"Получить"))),h["default"].createElement("label",{htmlFor:"file"},"Изображение в формате: png, jpg или gif"),h["default"].createElement("div",{className:"input-group"},h["default"].createElement("input",{id:"file",className:"form-control sharp",disabled:!this.state.tokenValid||this.state.url.length>0,ref:function(t){return e.file=t},type:"file"}),h["default"].createElement("span",{className:"input-group-btn"},h["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",disabled:!this.state.tokenValid||this.state.url.length>0,onClick:this.handleClearFile},"Очистить"))),h["default"].createElement("div",{className:"strike"},h["default"].createElement("span",null,"или ссылку на изображение")),h["default"].createElement("input",{className:"form-control sharp",disabled:!this.state.tokenValid,type:"text",value:this.state.url,onChange:this.handleURL,placeholder:"e.g. http://i.imgur.com/cPuty2U.png"}),h["default"].createElement("div",{className:"divider"}),h["default"].createElement("div",null,h["default"].createElement("button",{className:"btn btn-secondary sharp",type:"button",disabled:!this.state.tokenValid,onClick:this.handleLink},"Получить ссылку")),this.state.info.type&&h["default"].createElement("div",{className:"divider"}),this.state.info.type&&h["default"].createElement("div",{className:(0,p["default"])({alert:!0,"alert-danger":"error"==this.state.info.type,"alert-info":"message"==this.state.info.type,"alert-success":"link"==this.state.info.type}),role:"alert"},function(){return"link"==e.state.info.type?h["default"].createElement("div",{className:"input-group"},h["default"].createElement("input",{type:"text",ref:function(t){return e.linkInput=t},className:"form-control sharp",readOnly:!0,onClick:e.handleSelectAll,defaultValue:e.state.info.message}),h["default"].createElement("span",{className:"input-group-btn"},h["default"].createElement("button",{className:"btn btn-primary sharp",type:"button",onClick:e.handleCopyLink},"Скопировать"))):e.state.info.message}()))))},t}(f.Component);t["default"]=k},173:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.currentRoute;return o["default"].createElement("nav",{className:"navbar navbar-pills navbar-fixed-top",style:{background:"white"}},o["default"].createElement("ul",{className:"nav nav-pills navbar-nav"},o["default"].createElement("li",{className:(0,c["default"])({"nav-item":!0,active:"/"==t})},o["default"].createElement(i.Link,{className:"nav-link",to:"/"},"Me")),o["default"].createElement("li",{className:(0,c["default"])({"nav-item":!0,active:"/graffiti"==t})},o["default"].createElement(i.Link,{className:"nav-link",to:"/graffiti"},"Graffiti")),o["default"].createElement("li",{className:(0,c["default"])({"nav-item":!0,active:"/cover"==t})},o["default"].createElement(i.Link,{className:"nav-link",to:"/cover"},"Cover"))))}t.__esModule=!0,t["default"]=r;var l=a(4),o=n(l),i=a(138),s=a(110),c=n(s)},174:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(){return o["default"].createElement("div",{className:"vertical-center"},o["default"].createElement("div",{className:"container center-text"},o["default"].createElement("img",{src:s["default"],className:"img-fluid"}),o["default"].createElement("ul",{className:"links"},o["default"].createElement("li",null,o["default"].createElement("a",{href:"https://vk.com/ga2mer_o_o"},"VK")),o["default"].createElement("li",null,o["default"].createElement("a",{href:"https://twitter.com/ga2mer_ru"},"Twitter")))))}t.__esModule=!0,t["default"]=r;var l=a(4),o=n(l),i=a(333),s=n(i)},175:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=a(62),l=n(r),o=a(64),i=n(o),s=a(63),c=n(s),u=function(e){function t(a,n){(0,l["default"])(this,t);var r=(0,i["default"])(this,e.call(this));return r.name="VKError",r.message=a,r.error_code=n,r.stack=(new Error).stack,r}return(0,c["default"])(t,e),t}(Error);t["default"]=u},176:function(e,t){"use strict";!function(e){function t(e,t,a,n){var r,l,o,i,s,c,u,d=.3086*(1-n),f=.6094*(1-n),h=.082*(1-n),m=t<<2;for(o=0;o<a;o++)for(i=o*m,l=0;l<t;l++)r=i+(l<<2),s=e[r],c=e[r+1],u=e[r+2],e[r]=(d+n)*s+f*c+h*u,e[r+1]=d*s+(f+n)*c+h*u,e[r+2]=d*s+f*c+(h+n)*u}function a(e,a,i,s,c){var u=new Uint8Array(a*i*4);n(e,u,a,i,s),l(u,e,a,i,s),r(e,u,a,i,s),o(u,e,a,i,s),void 0!==c&&1!==c&&t(e,a,i,c)}function n(e,t,a,n,r){var l,o,i,s,c,u,d,f,h,m=r<<2,p=a<<2;for(o=0;o<n;o++){for(u=0,d=0,f=0,h=0,i=o*p,l=0;l<r;l++)s=i+(l<<2),u+=e[s],d+=e[s+1],f+=e[s+2],h+=e[s+3],t[s]=u/(l+1)|0,t[s+1]=d/(l+1)|0,t[s+2]=f/(l+1)|0,t[s+3]=h/(l+1)|0;for(;l<a;l++)s=i+(l<<2),c=s-m,t[s]=u/r|0,t[s+1]=d/r|0,t[s+2]=f/r|0,t[s+3]=h/r|0,u+=e[s]-e[c],d+=e[s+1]-e[c+1],f+=e[s+2]-e[c+2],h+=e[s+3]-e[c+3]}}function r(e,t,a,n,r){var l,o,i,s,c,u,d,f,h,m=r<<2,p=a<<2;for(o=0;o<n;o++){for(u=0,d=0,f=0,h=0,i=o*p,l=a-1;l>=a-r;l--)s=i+(l<<2),u+=e[s],d+=e[s+1],f+=e[s+2],h+=e[s+3],t[s]=u/(a-l)|0,t[s+1]=d/(a-l)|0,t[s+2]=f/(a-l)|0,t[s+3]=h/(a-l)|0;for(;l>=0;l--)s=i+(l<<2),c=s+m,t[s]=u/r|0,t[s+1]=d/r|0,t[s+2]=f/r|0,t[s+3]=h/r|0,u+=e[s]-e[c],d+=e[s+1]-e[c+1],f+=e[s+2]-e[c+2],h+=e[s+3]-e[c+3]}}function l(e,t,a,n,r){var l,o,i,s,c,u,d,f,h,m=a<<2,p=m*r;for(l=0;l<a;l++){for(u=0,d=0,f=0,h=0,i=l<<2,o=0;o<r;o++)s=i+o*m,u+=e[s],d+=e[s+1],f+=e[s+2],h+=e[s+3],t[s]=u/(o+1)|0,t[s+1]=d/(o+1)|0,t[s+2]=f/(o+1)|0,t[s+3]=h/(o+1)|0;for(;o<n;o++)s=i+o*m,c=s-p,t[s]=u/r|0,t[s+1]=d/r|0,t[s+2]=f/r|0,t[s+3]=h/r|0,u+=e[s]-e[c],d+=e[s+1]-e[c+1],f+=e[s+2]-e[c+2],h+=e[s+3]-e[c+3]}}function o(e,t,a,n,r){var l,o,i,s,c,u,d,f,h,m=a<<2,p=m*r;for(l=0;l<a;l++){for(u=0,d=0,f=0,h=0,i=l<<2,o=n-1;o>=n-r;o--)s=i+o*m,u+=e[s],d+=e[s+1],f+=e[s+2],h+=e[s+3],t[s]=u/(n-o)|0,t[s+1]=d/(n-o)|0,t[s+2]=f/(n-o)|0,t[s+3]=h/(n-o)|0;for(;o>=0;o--)s=i+o*m,c=s+p,t[s]=u/r|0,t[s+1]=d/r|0,t[s+2]=f/r|0,t[s+3]=h/r|0,u+=e[s]-e[c],d+=e[s+1]-e[c+1],f+=e[s+2]-e[c+2],h+=e[s+3]-e[c+3]}}function i(e,t,n,r,l,o){var i=this,u=i.canvas,d=0|n,f=0|r,h=0|e,m=0|t;l=32*(0|l),l=Math.min(Math.max(l,32),256);var p=Math.max(0,Math.log(l)/Math.log(2)-3|0),v=l>>>p,g=u.width>>>p,E=u.height>>>p;c.drawImage(u,0,0,g,E);var y=c.getImageData(0,0,g,E);return a(y.data,g,E,v,o),c.putImageData(y,0,0),c.drawImage(s,0,0,g,E,0,0,u.width,u.height),i.drawImage(s,h,m,d,f,h,m,d,f),i}var s=document.createElement("canvas");s.width=screen.width,s.height=screen.height;var c=s.getContext("2d");e.CanvasRenderingContext2D.prototype._blurRect=i}(window)},223:function(e,t){},330:function(e,t,a){e.exports=a.p+"hires.png"},331:function(e,t,a){e.exports=a.p+"lossy.png"},332:function(e,t,a){e.exports=a.p+"lossy_v2.png"},333:function(e,t,a){e.exports=a.p+"nagisa.png"},334:function(e,t,a){e.exports=a.p+"ram.png"},338:function(e,t,a){e.exports=a(169)}},[338]);